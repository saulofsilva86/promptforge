<!DOCTYPE html>
<html lang="pt-BR" data-theme="dark">
<head>
<!-- PWA -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#1a1a2e">
<script src="auth.js"></script>
<script>
    // Registrar Service Worker
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('./sw.js');
    }
    
    // Verificar autentica√ß√£o SEMPRE
    document.addEventListener('DOMContentLoaded', async function() {
        const usuario = await verificarAutenticacao();
        if (!usuario) {
            // J√° foi redirecionado pela fun√ß√£o
            return;
        }
        // Usu√°rio v√°lido, continua carregando o app
        console.log('‚úÖ Usu√°rio autenticado:', usuario.nome);
    });
</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PromptForge - Gerador de Prompts para Estampas</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        
        <!-- HEADER -->
<header class="header">
    <div class="header-top">
        <button class="theme-toggle" id="themeToggle" title="Alternar tema">
            <span class="icon-dark">üåô</span>
            <span class="icon-light">‚òÄÔ∏è</span>
        </button>
        
        <!-- NOVO: √Årea do usu√°rio -->
        <div class="user-area">
            <span class="user-greeting" id="userGreeting">Ol√°, Usu√°rio</span>
            <button class="btn-logout" id="btnLogout" title="Sair">
                üö™ Sair
            </button>
        </div>
    </div>

    <!-- NOVO: Indicador de status de conex√£o -->
    <div class="connection-status" id="connectionStatus">
        <span class="status-icon">üì°</span>
        <span class="status-text">Conectado</span>
    </div>

    <div class="logo-container">
        <div class="logo-icon">
            <svg viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <linearGradient id="bgGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" style="stop-color:#00f260"/>
                        <stop offset="50%" style="stop-color:#0575e6"/>
                        <stop offset="100%" style="stop-color:#f857a6"/>
                    </linearGradient>
                    <linearGradient id="boltGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" style="stop-color:#ffffff"/>
                        <stop offset="100%" style="stop-color:#e0e0e0"/>
                    </linearGradient>
                    <filter id="glow">
                        <feGaussianBlur stdDeviation="2" result="coloredBlur"/>
                        <feMerge>
                            <feMergeNode in="coloredBlur"/>
                            <feMergeNode in="SourceGraphic"/>
                        </feMerge>
                    </filter>
                </defs>
                <circle cx="50" cy="50" r="48" fill="url(#bgGradient)" opacity="0.9"/>
                <circle cx="50" cy="50" r="40" fill="#1a1a2e" opacity="0.8"/>
                <path d="M55 15 L35 45 L48 45 L43 85 L65 50 L52 50 L55 15Z" fill="url(#boltGradient)" filter="url(#glow)"/>
                <circle cx="25" cy="30" r="3" fill="#00f260" opacity="0.8"/>
                <circle cx="75" cy="70" r="3" fill="#f857a6" opacity="0.8"/>
                <circle cx="78" cy="35" r="2" fill="#0575e6" opacity="0.6"/>
                <circle cx="22" cy="65" r="2" fill="#00f260" opacity="0.6"/>
                <circle cx="50" cy="50" r="48" fill="none" stroke="url(#bgGradient)" stroke-width="2" opacity="0.5"/>
            </svg>
        </div>
        <div class="logo-text">
            <span class="logo-title">PromptForge</span>
            <span class="logo-tagline">Forjando Prompts Perfeitos</span>
        </div>
    </div>

    <p class="description">Gerador de Prompts Profissionais para Estampas de Camisetas</p>
    
    <div class="stats-bar">
        <div class="stat-item">
            <div class="stat-number">27</div>
            <div class="stat-label">Nichos</div>
        </div>
        <div class="stat-item">
            <div class="stat-number">12</div>
            <div class="stat-label">Estilos</div>
        </div>
        <div class="stat-item">
            <div class="stat-number">7</div>
            <div class="stat-label">Paletas</div>
        </div>
        <div class="stat-item">
            <div class="stat-number">3</div>
            <div class="stat-label">IAs</div>
        </div>
    </div>

    <!-- Quick Actions Header -->
    <div class="header-actions">
        <button class="header-btn" id="btnHistorico" title="Hist√≥rico">
            üìú Hist√≥rico
        </button>
        <button class="header-btn" id="btnFavoritos" title="Favoritos">
            ‚≠ê Favoritos
        </button>
    </div>
</header>

        <!-- FORM SECTION -->
        <section class="form-section">
            
            <!-- 1. NICHO -->
            <div class="form-group">
                <label>1. Escolha o Nicho</label>
                <p class="subtitle">Selecione a categoria principal da sua estampa</p>
                <div class="nicho-grid" id="nichoGrid">
                    <!-- Renderizado via JS -->
                </div>
                <div class="dica-nicho" id="dicaNicho">
                    <!-- Dica aparece aqui quando seleciona nicho -->
                </div>
            </div>

            <!-- 2. ESTILO -->
            <div class="form-group">
                <label for="styleSelect">2. Escolha o Estilo Visual</label>
                <select id="styleSelect">
                    <option value="">Selecione um estilo...</option>
                    <!-- Renderizado via JS -->
                </select>
            </div>

            <!-- 3. PALETA -->
            <div class="form-group">
                <label>3. Paleta de Cores</label>
                <p class="subtitle">Escolha o clima crom√°tico da estampa</p>
                <div class="paleta-grid" id="paletaGrid">
                    <!-- Renderizado via JS -->
                </div>
            </div>

            <!-- 4. IDEIA -->
            <div class="form-group">
                <label for="themeInput">4. Descreva sua Ideia</label>
                <p class="subtitle">Seja espec√≠fico: personagens, a√ß√µes, cen√°rios, frases...</p>
                <textarea id="themeInput" placeholder="Ex: Jogador de t√™nis fazendo um saque potente com explos√£o de energia"></textarea>
                
                <div class="idea-actions">
                    <button class="btn-idea" id="btnGerarIdeia">
                        üé≤ Gerar Ideia Aleat√≥ria
                    </button>
                    <button class="btn-idea" id="btnOutraIdeia" disabled>
                        üîÑ Outra Ideia
                    </button>
                </div>

                <div class="categoria-filter" id="categoriaFilter">
                    <span class="filter-label">Filtrar por:</span>
                    <div class="categoria-pills" id="categoriaPills">
                        <!-- Renderizado via JS -->
                    </div>
                </div>
            </div>

            <!-- 5. IMAGEM REFER√äNCIA -->
            <div class="form-group">
                <label for="imageRef">5. Imagem de Refer√™ncia <span class="optional">(opcional)</span></label>
                <p class="subtitle">Cole a URL de uma imagem para usar como refer√™ncia de estilo</p>
                <input type="url" id="imageRef" placeholder="https://exemplo.com/imagem.jpg">
                
                <div class="image-preview-container" id="imagePreviewContainer">
                    <div class="image-preview" id="imagePreview">
                        <!-- Preview aparece aqui -->
                    </div>
                    <div class="image-info">
                        <span class="image-status" id="imageStatus"></span>
                        <button class="btn-remove-image" id="btnRemoveImage">‚ùå Remover</button>
                    </div>
                </div>

                <div class="image-note">
                    <strong>üí° Como usar no Gemini:</strong> Salve a imagem e fa√ßa upload junto com o prompt gerado.
                    <br><small>Midjourney aceita URL direta. Leonardo requer upload.</small>
                </div>
            </div>

            <!-- MIDJOURNEY ADVANCED (toggle) -->
            <div class="form-group advanced-section" id="advancedSection">
                <div class="advanced-toggle">
                    <label class="toggle-switch">
                        <input type="checkbox" id="advancedMode">
                        <span class="toggle-slider"></span>
                    </label>
                    <span>Modo Avan√ßado (Midjourney)</span>
                </div>

                <div class="advanced-options" id="advancedOptions">
                    <div class="advanced-row">
                        <div class="advanced-field">
                            <label>Aspect Ratio</label>
                            <select id="mjAspect">
                                <option value="1:1" selected>1:1 (Quadrado)</option>
                                <option value="4:5">4:5 (Retrato)</option>
                                <option value="5:4">5:4 (Paisagem)</option>
                                <option value="2:3">2:3 (Vertical)</option>
                                <option value="3:2">3:2 (Horizontal)</option>
                            </select>
                        </div>
                        <div class="advanced-field">
                            <label>Vers√£o</label>
                            <select id="mjVersion">
                                <option value="6.1" selected>v6.1 (Mais recente)</option>
                                <option value="6">v6</option>
                                <option value="5.2">v5.2</option>
                            </select>
                        </div>
                        <div class="advanced-field">
                            <label>Estilo</label>
                            <select id="mjStyle">
                                <option value="raw" selected>Raw (Menos filtro)</option>
                                <option value="cute">Cute</option>
                                <option value="scenic">Scenic</option>
                                <option value="expressive">Expressive</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <!-- BUTTONS -->
            <div class="buttons">
                <button class="btn btn-primary" id="btnGerar">
                    ‚ö° Gerar Prompts
                </button>
                <button class="btn btn-random" id="btnSurpresa">
                    üé≤ Surpresa Total!
                </button>
            </div>
        </section>

        <!-- RESULT SECTION -->
        <section class="result-section" id="resultSection">
            <div class="result-header">
                <h2>üìã Prompts Gerados</h2>
                <div class="badges" id="resultBadges">
                    <!-- Badges renderizados via JS -->
                </div>
            </div>

            <!-- AI Recommendation -->
            <div class="ai-recommendation" id="aiRecommendation">
                <!-- Recomenda√ß√£o renderizada via JS -->
            </div>

            <!-- PROMPT BOXES -->
            <div class="prompt-cards">
                
                <!-- Leonardo.ai -->
                <div class="prompt-card" data-ai="leonardo">
                    <div class="prompt-card-header">
                        <div class="prompt-card-title">
                            <span class="ai-icon">üé®</span>
                            <span>Leonardo.ai</span>
                        </div>
                        <button class="btn-copy" data-target="promptLeonardo">üìã Copiar</button>
                    </div>
                    <div class="prompt-box" id="promptLeonardo"></div>
                    <div class="prompt-tip" id="tipLeonardo"></div>
                </div>

                <!-- Midjourney -->
                <div class="prompt-card" data-ai="midjourney">
                    <div class="prompt-card-header">
                        <div class="prompt-card-title">
                            <span class="ai-icon">üé≠</span>
                            <span>Midjourney</span>
                        </div>
                        <button class="btn-copy" data-target="promptMidjourney">üìã Copiar</button>
                    </div>
                    <div class="prompt-box" id="promptMidjourney"></div>
                    <div class="prompt-tip" id="tipMidjourney"></div>
                </div>

               <!-- Gemini -->
<div class="prompt-card" data-ai="gemini">
    <div class="prompt-card-header">
        <div class="prompt-card-title">
            <span class="ai-icon">üçå</span>
            <span>Gemini</span>
        </div>
        <div class="prompt-card-actions">
            <button class="btn-copy" data-target="promptGemini">üìã Copiar</button>
            <button class="btn-open-ai" id="btnAbrirGemini">üöÄ Abrir no Gemini</button>
        </div>
    </div>
    <div class="prompt-box" id="promptGemini"></div>
    <div class="prompt-tip" id="tipGemini"></div>
</div>

            </div>

            <!-- Result Actions -->
            <div class="result-actions">
                <button class="btn-action" id="btnCopiarTodos">
                    üìã Copiar Todos
                </button>
                <button class="btn-action" id="btnFavoritar">
                    ‚≠ê Favoritar
                </button>
                <button class="btn-action" id="btnExportar">
                    üì§ Exportar
                </button>
                <button class="btn-action" id="btnNegative">
                    üö´ Negative Prompt
                </button>
            </div>

            <!-- Info Box -->
            <div class="info-box" id="infoBox">
                <!-- Info renderizada via JS -->
            </div>
        </section>

        <!-- FOOTER -->
        <footer>
            <p>PromptForge - Crie estampas incr√≠veis com IA</p>
            <p class="footer-sub">Otimizado para Leonardo.ai, Midjourney e Gemini</p>
        </footer>
    </div>

    <!-- MODAIS -->

    <!-- Modal Profiss√µes -->
    <div class="modal" id="modalProfissoes">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üíº Escolha a Profiss√£o</h3>
                <button class="modal-close" data-modal="modalProfissoes">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="submenu-grid" id="profissoesGrid">
                    <!-- Renderizado via JS -->
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Signos -->
    <div class="modal" id="modalSignos">
        <div class="modal-content">
            <div class="modal-header">
                <h3>‚ôå Escolha o Signo</h3>
                <button class="modal-close" data-modal="modalSignos">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="submenu-grid" id="signosGrid">
                    <!-- Renderizado via JS -->
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Hist√≥rico -->
    <div class="modal" id="modalHistorico">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3>üìú Hist√≥rico de Prompts</h3>
                <button class="modal-close" data-modal="modalHistorico">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="historico-list" id="historicoList">
                    <!-- Renderizado via JS -->
                </div>
                <div class="historico-empty" id="historicoEmpty">
                    <p>Nenhum prompt gerado ainda.</p>
                    <p>Seus prompts aparecer√£o aqui! üöÄ</p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-modal-action" id="btnLimparHistorico">üóëÔ∏è Limpar Hist√≥rico</button>
            </div>
        </div>
    </div>

    <!-- Modal Favoritos -->
    <div class="modal" id="modalFavoritos">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3>‚≠ê Favoritos</h3>
                <button class="modal-close" data-modal="modalFavoritos">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="favoritos-list" id="favoritosList">
                    <!-- Renderizado via JS -->
                </div>
                <div class="favoritos-empty" id="favoritosEmpty">
                    <p>Nenhum favorito salvo.</p>
                    <p>Clique em ‚≠ê para salvar seus melhores prompts!</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Exportar -->
    <div class="modal" id="modalExportar">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üì§ Exportar Prompts</h3>
                <button class="modal-close" data-modal="modalExportar">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="export-options">
                    <button class="export-btn" id="exportTxt">
                        üìÑ Salvar como .TXT
                    </button>
                    <button class="export-btn" id="exportCopy">
                        üìã Copiar Formatado
                    </button>
                    <button class="export-btn" id="exportWhatsapp">
                        üí¨ Compartilhar WhatsApp
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Negative Prompt -->
    <div class="modal" id="modalNegative">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üö´ Negative Prompt</h3>
                <button class="modal-close" data-modal="modalNegative">‚úï</button>
            </div>
            <div class="modal-body">
                <p class="negative-info">Use este negative prompt para evitar elementos indesejados:</p>
                <div class="prompt-box negative-box" id="negativePromptBox">
                    <!-- Renderizado via JS -->
                </div>
                <button class="btn btn-primary" id="btnCopyNegative" style="margin-top: 15px; width: 100%;">
                    üìã Copiar Negative Prompt
                </button>
            </div>
        </div>
    </div>

    <!-- TOAST -->
    <div class="toast" id="toast">
        <span id="toastMessage">Copiado!</span>
    </div>

    <!-- SCRIPTS -->
    <script src="data.js"></script>
    <script src="app.js"></script>
</body>
</html>